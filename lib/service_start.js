// Generated by CoffeeScript 1.9.1
var execute;

module.exports = function(options, callback) {
  if (!options.name) {
    return callback(new Error("Missing required option 'name'"));
  }
  return this.child().execute({
    ssh: options.ssh,
    cmd: "service " + options.name + " status",
    code_skipped: [3, 1],
    log: options.log,
    stdout: options.stdout,
    stderr: options.stderr,
    shy: true
  }, function(err, started) {
    if (err) {
      return callback(err);
    }
    return options.db["mecano.service.start." + options.name + ".status"] = started ? 'started' : 'stopped';
  }).execute({
    ssh: options.ssh,
    cmd: "service " + options.name + " start",
    log: options.log,
    stdout: options.stdout,
    stderr: options.stderr,
    not_if: function(options) {
      return options.db["mecano.service.start." + options.name + ".status"] === 'started';
    }
  }, function(err, executed) {
    if (err) {
      return callback(err);
    }
    return options.db["mecano.service.start." + options.name + ".status"] === 'started';
  }).then(callback);
};

execute = require('./execute');
