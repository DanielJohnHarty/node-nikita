// Generated by CoffeeScript 1.12.4
module.exports = function(options) {
  options.log({
    message: "Entering service.stop",
    level: 'DEBUG',
    module: 'nikita/lib/service/stop'
  });
  if (typeof options.argument === 'string') {
    if (options.name == null) {
      options.name = options.argument;
    }
  }
  if (!options.name) {
    throw Error("Invalid Name: " + (JSON.stringify(options.name)));
  }
  options.log({
    message: "Stop service " + options.name,
    level: 'INFO',
    module: 'nikita/lib/service/stop'
  });
  return this.system.execute({
    cmd: "ls /lib/systemd/system/*.service /etc/systemd/system/*.service /etc/rc.d/* /etc/init.d/* 2>/dev/null | grep -w \"" + options.name + "\" || exit 3\nif which systemctl >/dev/null 2>&1; then\n  systemctl status " + options.name + " || exit 3\n  systemctl stop " + options.name + "\nelif which service >/dev/null 2>&1; then\n  service " + options.name + " status || exit 3\n  service " + options.name + " stop\nelse\n  echo \"Unsupported Loader\" >&2\n  exit 2\nfi",
    code_skipped: 3,
    arch_chroot: options.arch_chroot,
    rootdir: options.rootdir
  }, function(err, status) {
    if (!err && !status) {
      options.log({
        message: "Service already stopped",
        level: 'WARN',
        module: 'nikita/lib/service/stop'
      });
    }
    if (!err && status) {
      return options.log({
        message: "Service is stopped",
        level: 'INFO',
        module: 'nikita/lib/service/stop'
      });
    }
  });
};
