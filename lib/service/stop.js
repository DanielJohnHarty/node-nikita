// Generated by CoffeeScript 1.10.0
module.exports = function(options, callback) {
  if (!options.name) {
    return callback(new Error("Missing required option 'name'"));
  }
  return this.service_status({
    name: options.name,
    code_started: options.code_started,
    code_stopped: options.code_stopped,
    shy: true
  }).execute({
    cmd: "service " + options.name + " stop",
    unless: function() {
      return options.store["mecano.service." + options.name + ".status"] === 'stopped';
    }
  }, function(err, stopped) {
    if (err) {
      throw err;
    }
    if (stopped) {
      return options.store["mecano.service." + options.name + ".status"] = 'stopped';
    }
  }).then(callback);
};
