// Generated by CoffeeScript 1.10.0
var fs;

module.exports = function(options, callback) {
  options.log({
    message: "Entering touch",
    level: 'DEBUG',
    module: 'mecano/lib/touch'
  });
  if (options.argument != null) {
    options.target = options.argument;
  }
  if (!options.target) {
    return callback(new Error("Missing target: " + options.target));
  }
  options.log({
    message: "Check if target exists \"" + options.target + "\"",
    level: 'DEBUG',
    module: 'mecano/lib/touch'
  });
  return fs.exists(options.ssh, options.target, (function(_this) {
    return function(err, exists) {
      if (err) {
        return callback(err);
      }
      if (exists) {
        return callback();
      }
      options.log({
        message: "Destination does not exists",
        level: 'INFO',
        module: 'mecano/lib/touch'
      });
      _this.write({
        content: '',
        target: options.target
      });
      return _this.then(callback);
    };
  })(this));
};

fs = require('ssh2-fs');
