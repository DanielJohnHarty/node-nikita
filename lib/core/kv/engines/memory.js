// Generated by CoffeeScript 2.3.1
// # `nikita.kv.memory`

// ## Source Code
module.exports = function() {
  return {
    db: {},
    set: function(key, value) {
      var base, base1, listener, results;
      if ((base = this.db)[key] == null) {
        base[key] = {};
      }
      this.db[key].value = value;
      if ((base1 = this.db[key]).listeners == null) {
        base1.listeners = [];
      }
      results = [];
      while (listener = this.db[key].listeners.shift()) {
        results.push(listener.call(null, null, this.db[key].value));
      }
      return results;
    },
    get: function(key, callback) {
      var base, base1, ref;
      if ((ref = this.db[key]) != null ? ref.value : void 0) {
        return callback(null, this.db[key].value);
      }
      if ((base = this.db)[key] == null) {
        base[key] = {};
      }
      if ((base1 = this.db[key]).listeners == null) {
        base1.listeners = [];
      }
      return this.db[key].listeners.push(callback);
    }
  };
};
