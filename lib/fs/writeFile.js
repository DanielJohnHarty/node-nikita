// Generated by CoffeeScript 2.1.1
// # `nikita.fs.writeFile(options, callback)`

// Options include

// * `content` (string|buffer)   
//   Content to write.
// * `flags` (string)   
//   File flags, see [open(2)](http://man7.org/linux/man-pages/man2/open.2.html).
// * `mode` (string|int)   
//   Permission mode.
// * `target` (string)   
//   Final destination path.
// * `target_tmp` (string)   
//   Temporary file for upload before moving to final destination path.

// ## Source Code
var fs, string;

module.exports = {
  status: false,
  handler: function(options) {
    var ssh;
    options.log({
      message: "Entering fs.writeFile",
      level: 'DEBUG',
      module: 'nikita/lib/fs/writeFile'
    });
    ssh = this.ssh(options.ssh);
    if (options.argument != null) {
      // Normalize options
      options.target = options.argument;
    }
    if (!options.target) {
      throw Error("Required Option: the \"target\" option is mandatory");
    }
    return this.fs.createWriteStream({
      target: options.target,
      flags: options.flags,
      mode: options.mode,
      stream: function(ws) {
        ws.write(options.content);
        return ws.end();
      }
    });
  }
};

// ## Dependencies
fs = require('ssh2-fs');

string = require('../misc/string');
