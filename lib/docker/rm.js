// Generated by CoffeeScript 1.10.0
var docker, util;

module.exports = function(options, callback) {
  var cmd, i, len, opt, ref;
  if (options.container == null) {
    return callback(Error('Missing container parameter'));
  }
  cmd = ' rm ';
  ref = ['link', 'volumes', 'force'];
  for (i = 0, len = ref.length; i < len; i++) {
    opt = ref[i];
    if (options[opt]) {
      cmd += "-" + (opt.charAt(0)) + " ";
    }
  }
  cmd += options.container;
  return docker.exec(" ps | grep '" + options.container + "' ", options, true, function(err, executed, stdout, stderr) {
    if (err) {
      return callback(err, executed, stdout, stderr);
    }
    if (executed) {
      if (options.force) {
        return docker.exec(cmd, options, false, function(err, executed, stdout, stderr) {
          return callback(err, executed, stdout, stderr);
        });
      } else {
        return callback(Error('Container must be stopped to be removed without force'));
      }
    } else {
      return docker.exec(" ps -a | grep '" + options.container + "' ", options, true, function(err, executed, stdout, stderr) {
        if (err || !executed) {
          return callback(err, executed, stdout, stderr);
        }
        if (executed) {
          return docker.exec(cmd, options, true, function(err, executed, stdout, stderr) {
            return callback(err, executed, stdout, stderr);
          });
        }
      });
    }
  });
};

docker = require('../misc/docker');

util = require('util');
