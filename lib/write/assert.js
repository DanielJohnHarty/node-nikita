// Generated by CoffeeScript 1.10.0
var fs;

module.exports = function(options) {
  options.log({
    message: "Entering assert",
    level: 'DEBUG',
    module: 'mecano/lib/assert'
  });
  if (options.encoding == null) {
    options.encoding = 'utf8';
  }
  if (options.target == null) {
    options.target = options.source;
  }
  if (options.content == null) {
    throw Error("Required option 'content'");
  }
  if (!options.target) {
    throw Error("Required option 'target'");
  }
  if (typeof options.content === 'string') {
    options.content = Buffer.from(options.content, options.encoding);
  } else if (!Buffer.isBuffer(otions.content)) {
    throw Error("Invalid option 'content': expect string or buffer");
  }
  return this.call(function(_, callback) {
    return fs.readFile(options.target, function(err, buffer) {
      if (!(err || buffer.equals(options.content))) {
        if (options.error == null) {
          options.error = "Invalid content match: expected " + (JSON.stringify(options.content.toString())) + ", got " + (JSON.stringify(buffer.toString()));
        }
        err = Error(options.error);
      }
      return callback(err);
    });
  });
};

fs = require('fs');
