// Generated by CoffeeScript 1.8.0
var exec, glob, minimatch, path;

path = require('path');

glob = require('glob');

minimatch = require('minimatch');

exec = require('ssh2-exec');

module.exports = function(ssh, pattern, callback) {
  if (ssh) {
    pattern = path.normalize(pattern);
    return exec(ssh, "find -f " + pattern, function(err, stdout) {
      var files;
      if (err) {
        return callback(err);
      }
      files = stdout.trim().split(/\r\n|[\n\r\u0085\u2028\u2029]/g);
      files = files.filter(function(file) {
        return minimatch(file, pattern);
      });
      return callback(err, files);
    });
  } else {
    return glob("" + pattern, function(err, files) {
      return callback(err, files);
    });
  }
};
