// Generated by CoffeeScript 1.12.5
var each, glob, misc;

module.exports = function(options, callback) {
  options.log({
    message: "Entering remove",
    level: 'DEBUG',
    module: 'nikita/lib/system/remove'
  });
  if (options.argument != null) {
    options.target = options.argument;
  }
  if (options.target == null) {
    options.target = options.source;
  }
  if (options.target == null) {
    return callback(Error("Missing option: \"target\""));
  }
  return glob(options.ssh, options.target, function(err, files) {
    var status;
    if (err) {
      return callback(err);
    }
    status = false;
    return each(files).call(function(file, callback) {
      status = true;
      options.log({
        message: "Removing file " + file,
        level: 'INFO',
        module: 'nikita/lib/system/remove'
      });
      return misc.file.remove(options.ssh, file, callback);
    }).then(function(err) {
      return callback(err, status);
    });
  });
};

each = require('each');

misc = require('../misc');

glob = require('../misc/glob');
